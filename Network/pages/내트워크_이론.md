LAN (Local Area Network) // HUB // MAC //

## LAN

컴퓨터는 전기로 신호를 준다.

컴퓨터와 컴퓨터는 선 / 전자기파로 통신

HUB : 여러 컴퓨터가 케이블로 연결되는데 케이블 연결을 도와주는 디바이스
    하지만 더 좋은 게 생겨서 지금 사용하지 않는다.
    - 허브는 A에서 B로 보낼라고 하면 C, D ... 으로 정보가 전달된다.
    - 데이터 충동 문제
      - CSMA/CD로 해결은 가능

MAC 주소 : A가 데이터를 보내면서 B한테 보낸다라는 정보를 넣으면 되는데 그 정보가 MAC 주소다.
    - 각 컴퓨터마다 고유의 MAC 주소를 가지고 있다.


프레임 : 정보를 보낼 때 Frame 형식으로 정보를 보낸다.
- 목적지 MAC 주소 + 소스(출발지) MAC 주소 + 데이터
- IEEE 802.3 ETHERNET Frame Format

스위치 : 허브의 단점으로 생겼다.
    - Mac 주소들을 저장한다.

<br>

> 라우터 : 만약 철수의 집과 영희의 집에 LAN이 있을 때 둘의 LAN을 연결해주는 역할
> WAN : 라우터에 들어가는 순간 WAN에 진입을 하게 된다.

---

> 인터넷 : 수많은 라우터들이 연결이 되어있는 것 = WAN

---
## WAN
LAN은 MAC 주소를 통해 소통을 했지만 라우터는 IP 주소를 이용한다.

프레임: LAN은 MAC주소만은 충분하지 않아서 데이터 안에다가 IP 패킷을 넣는다.
    - IP 패킷 : 간단하게 작성하면 소스 ip 주소 | 목적지 ip 주소 | 데이터 형태


라우팅 : 
- 정보를 보내기 위해선 프레임을 사용해야하는데 그러기 위해서 보내기 위한 MAC 주소와 보내는 쪽(라우터)의 MAC 주소를 알아야 하는데 방금 보냈으니 라우터 MAC 주소를 모른다. 
- 다행이도 IP 주소는 안다. 왜냐하면 IP 주소는 전략적으로 할당되기 떄문에다. (맥에서는 Router 윈도우에서는 Default Gateway)라고 한다.
- 물론 아직 MAC 주소는 모르지만 ip 주소를 통해 MAC 주소를 알 수 있는데 이게 ARP(Address Resolution Protocol)이다.


    IP 주소 vs MAC 주소
    - MAC 주소는 하드웨어의 정보를 가지고 있고, IP 주소는 하드웨어 위치 정보를 가지고 있다.

ARP
- LAN은 패킷을 통해 정보를 주고 받는다.
- 라우터를 통해 정보를 주고 받을라면 라우터의 MAC 주소를 알아야 한다.
- 현재는 라우터의 IP 주소만 가지고 있다. 
- 이떄 ARP가 라우터의 IP 주소를 가지고 MAC 주소를 찾아준다.
  1. 프레임과 request ARP 패킷 생성 - 패킷 : 이 라우터 IP 주소의 mac 주소가 뭐야?
  2. 프레임과 ARP 패킷 브로드캐스트(방송) - LAN과 연결되어 있는 모든 디바이스에게 방송을 한다.
  3. 목적지 ip 주소 확인 : 자기 ip 주소와 라우터 ip 주소가 맞는 지 확인하는데 이때 라우터 ip 주소와 동일하단 걸 확인
  4. 프레임과 reply ARP 패킷 생성 : 라우터는 ARP를 확인하고 라우터는 내 MAC주소는 ~야 라는 reply 패킷을 생성한다.
  5. 프레임과 MAC 주소가 담긴 APR 답장 패킷 전송 : 이제는 보낼라는 디바이스에서 라우터 MAC 주소를 알게 된다. 
  6. 프레임과 ip 패킷 전송 : 이제 제대로된 프레임을 만들어 라우터에게 보낼 수 있다. 그럼 ip 패킷을 받아서 다음 라우터에게 보내준다. 



Ethernet 프레임과 APR 패킷
Ethernet 프레임 : 목적지 MAC 맥주소 , 소스 MAC 주소, 데이터가 있었는데 우리의 목적은 ARP Request를 위한 이더넷 프레임이기 때문에 다음과 같다.

Ethernet Frame for APR Request
- PREAMBLE :
- SFD : 10101011 (1bype) : 이 패턴이 끝나고 나면 데이터가 시작하는 거야
- 목직지 MAC 주소 : ARP 2번을 해야한다. 현재는 모르기 때문에 ff.ff.ff.ff.ff.ff이다.
- 소스 MAC 주소 : 
- LENGTH : 이 프레임의 총 길이
- Ethernet Type : 뒤에 나오는 데이터가 뭔 지 알려준다.
  - ex. 0806 : 뒤에 ARP 패킷이 나온다.
  - ex. 0800 : 뒤에 IP 패킷이 나온다.
- 데이터 : [APR Request](#arp-request-패킷) 패킷을 넣는다.
- CRC : 4 bype - 해시 패턴 앞에 내용을 다 읽고서 이 패턴이 맞으면 데이터가 제대로 전송된 것이다.

### ARP Request 패킷
- 하드웨어 타입 : 이 패킷이 어떤 네트워크(프레임) 안에 있냐 
- 프로토콜 타입 : 현재 사용하고 있는 프로토콜이 무엇인가 = 0800H = IPv$
- 하드웨어 길이 : MAC 주소의 길이
- 프로토콜 길이 : IP 주소의 길이
- Operation : 1이면 request, 2이면 reply
- 보내는 쪽 MAC 주소
- 보내는 쪽 IP 주소
- 받는 쪽 MAC 주소 : 현재 모름 - 여기를 알라고 한다.
- 받는 쪽 IP 주소 : 받는쪽 IP 주소



Ethernet Frame for APR Reply
- PREAMBLE :
- SFD : 10101011 (1bype) : 이 패턴이 끝나고 나면 데이터가 시작하는 거야
- 목직지 MAC 주소 : ARP 2번을 해야한다. 현재는 모르기 때문에 ff.ff.ff.ff.ff.ff이다.
- 소스 MAC 주소 : 
- LENGTH : 이 프레임의 총 길이
- Ethernet Type : 뒤에 나오는 데이터가 뭔 지 알려준다.
  - ex. 0806 : 뒤에 ARP 패킷이 나온다.
  - ex. 0800 : 뒤에 IP 패킷이 나온다.
- 데이터 : [APR Reply](#arp-reply-패킷) 패킷을 넣는다.
- CRC : 4 bype - 해시 패턴 앞에 내용을 다 읽고서 이 패턴이 맞으면 데이터가 제대로 전송된 것이다.

### ARP Reply 패킷
- 하드웨어 타입 : 이 패킷이 어떤 네트워크(프레임) 안에 있냐 
- 프로토콜 타입 : 현재 사용하고 있는 프로토콜이 무엇인가 = 0800H = IPv$
- 하드웨어 길이 : MAC 주소의 길이
- 프로토콜 길이 : IP 주소의 길이
- Operation : 1이면 request, 2이면 reply
- 보내는 쪽 라우터 MAC 주소
- 보내는 쪽 라우터 IP 주소
- 받는 쪽 MAC 주소 : 컴퓨터 MAC 주소
- 받는 쪽 IP 주소 : 컴퓨터 IP 주소




APR 정리






















